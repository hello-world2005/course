#include <cstdio>
const int _ = 1000, __ = 20, ___ = 31, ____ = 1000000007;
int _____, ______, _______, ________, _________, __________, ___________,
    ____________, _____________, ______________, _______________[_][__],
    ________________[_][__], _________________[_];
int __________________________[__][__], ___________________________[__][__],
    ____________________[___][__][__], _____________________[___][__][__],
    ________________________[__][__];
void __________________(int& ______________________,
                        int _______________________) {
  ______________________ += _______________________;
  if (______________________ >= ____)
    ______________________ -= ____;
}
void ___________________(int ____________________[][__],
                         int _____________________[][__]) {
  int ________, _________, __________;
  for (________ = 0; ________ < ______; ________++)
    for (_________ = 0; _________ < ______; _________++) {
      int _________________________ = 0;
      for (__________ = 0; __________ < ______; __________++)
        _________________________ =
            (1LL * ____________________[________][__________] *
                 _____________________[__________][_________] +
             _________________________) %
            ____;
      ________________________[________][_________] = _________________________;
    }
}
void cal(int _____) {
  for (________ = 0; ________ < ______; ________++)
    for (_________ = 0; _________ < ______; _________++)
      __________________________[________][_________] = 0;
  if (_____ < 0)
    return;
  for (________ = 0; ________ < ______; ________++)
    for (_________ = 0; _________ < ______; _________++)
      ___________________________[________][_________] = 0;
  for (________ = 0; ________ < ______; ________++)
    __________________________[________][________] =
        ___________________________[________][________] = 1;
  for (________ = 0; ________ < ___; ________++)
    if (_____ >> ________ & 1) {
      for (___________________(_____________________[________],
                               ___________________________),
           _________ = 0;
           _________ < ______; _________++)
        for (__________ = 0; __________ < ______; __________++)
          __________________(__________________________[_________][__________],
                             ________________________[_________][__________]);
      for (___________________(___________________________,
                               ____________________[________]),
           _________ = 0;
           _________ < ______; _________++)
        for (__________ = 0; __________ < ______; __________++)
          ___________________________[_________][__________] =
              ________________________[_________][__________];
    }
}
int main() {
  for (scanf("%d%d", &_____, &______); ________ < _____; ________++) {
    for (_________ = 0; _________ < ______; _________++)
      scanf("%d", &_______________[________][_________]);
    for (_________ = 0; _________ < ______; _________++)
      scanf("%d", &________________[________][_________]);
  }
  for (__________ = 0; __________ < _____; __________++)
    for (________ = 0; ________ < ______; ________++)
      for (_________ = 0; _________ < ______; _________++)
        ____________________[0][________][_________] =
            (1LL * ________________[__________][________] *
                 _______________[__________][_________] +
             ____________________[0][________][_________]) %
            ____;
  for (________ = 0; ________ < ______; ________++)
    for (_________ = 0; _________ < ______; _________++)
      _____________________[0][________][_________] =
          ____________________[0][________][_________];
  for (________ = 0; ________ < ___ - 1; ________++) {
    for (___________________(____________________[________],
                             ____________________[________]),
         _________ = 0;
         _________ < ______; _________++)
      for (__________ = 0; __________ < ______; __________++)
        ____________________[________ + 1][_________][__________] =
            ________________________[_________][__________];
    for (_________ = 0; _________ < ______; _________++)
      __________________(____________________[________][_________][_________],
                         1);
    for (___________________(_____________________[________],
                             ____________________[________]),
         _________ = 0;
         _________ < ______; _________++)
      for (__________ = 0; __________ < ______; __________++)
        _____________________[________ + 1][_________][__________] =
            ________________________[_________][__________];
    for (_________ = 0; _________ < ______; _________++)
      __________________(____________________[________][_________][_________],
                         ____ - 1);
  }
  scanf("%d", &_______);
  while (_______--) {
    scanf("%d%d%d", &___________, &____________, &_____________);
    ___________--;
    ____________--;
    cal(_____________ - 1);
    for (________ = 0; ________ < ______; ________++)
      for (_________________[________] = _________ = 0; _________ < ______;
           _________++)
        _________________[________] =
            (1LL * _______________[___________][_________] *
                 __________________________[_________][________] +
             _________________[________]) %
            ____;
    for (______________ = ________ = 0; ________ < ______; ________++)
      ______________ = (1LL * _________________[________] *
                            ________________[____________][________] +
                        ______________) %
                       ____;
    printf("%d\n", (______________ + (___________ == ____________)) % ____);
  }
  return 0;
}