# 太空飞行计划

~~此题难点在读入上。~~

求最大权闭合子图。

建图显然，左边实验，右边仪器，边权为获利或花费。

求方案的话判断满流就可以了。

~~自学~~

## 最小割

### 最小割定义

$G = (V, E)$，源点 S，汇点 T，给出一个边集 $E' \subseteq E$，使得删去 $E'$ 中的边后，S 与 T 不在联通，则称 $E'$ 为割。

最小割即为边的流量和最小的割。

### 最大流最小割定理

**最大流等于最小割**

##### 引理：

可行流的流量一定小于等于最小割的流量。

证明显然。

对于一个可行流 G，有最大流 F，那么

1. F 是最大流；
2. G 中不再存在增广路；
3. 存在一个割使得其容量等于 F 的流量。

证明三个问题等价即可。

对于 1 和 2，如果 G 中仍然存在增广路，那么 F 显然可以继续增大；反之，如果不存在，则 F 不可以继续增大，因为没有了从 S 到 T 的路径。

对于 1 和 3，由引理 1 得，流量上界为最小割的流量和。如果当前割流量 $C$ 不是最小的，那么一定存在 $C' < C$，又因为 $C = F \le C'$，矛盾，故 $C$ 为最小。

证毕。

所以最大流等于最小割。

## 最大权闭合子图

### 闭合子图

子图内所有点的出边都指向子图内的点。

![{^opGr1](\太空飞行计划\幻灯片1.PNG)

上图中有：

- 1，2，5
- 1，2，4，5
- 1，2，3，4，5
- 2，5
- 2，4，5
- 2，3，4，5
- 5

为此图闭合子图。

### 最大权闭合子图

给每个点带上权值，权值和最大的闭合子图。

![](\太空飞行计划\幻灯片2.PNG)

#### 怎么求？

$2^n$ 暴力算（

考虑网络流建模，新建源汇 S、T，S 向所有点权为正的点连边，T 向所有点权为负的点连边，原图内所有的边权值改为 $+\infty$。

![](太空飞行计划\幻灯片3.PNG)

（边权略）

跑一遍最大流就好了。

#### 证明

严谨来证明我也不是很会qwq，大概感性理解一下。

对于图中任意一个最小割，都可以把图分成两部分，暂且称与 S 相连的部分为 A，与 T 相邻的部分为 B。A 是选择在最大权闭合子图中的，B 是被我们丢弃的。

首先，A 为什么是一个闭合子图。

如果 A 不是一个闭合子图，那么 S 到 T 必然还有残余流量，那么最大流还可以继续增大。

那么这样跑出来的为什么是最大权。

既然 A 部分是我们需要的，那么让他越大越好，B 部分是我们要丢弃的，让他越小越好。B 部分是和 T 相连的，也就是说里面的都是负权，那么负的越多越好，在图上边权是正的，也就是我们要让这一部分的和也尽量大。A、B 部分的权值和都要尽量大，就说明割（两部分的分界线，权值不计算在内）要越小越好。

那也就是最小割，即最大流。



