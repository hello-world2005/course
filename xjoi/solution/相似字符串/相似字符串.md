# 相似字符串

看到恰好 $D$ 个，且 $D \le 4$，想到容斥。

枚举至少哪几位相同，用一个二进制数 $mask$ 表示，最多四位，所以 $0 \le mask \le 15$，乘上 $n$，时间复杂度可以接受（听 wzc 说可以二项式反演？）。

在枚举 $mask$ 判断两个字符串是否相似时，可以将当前可以不同几位设为一个通配符然后存到  哈希表里，这样可以 $O(n*\text{哈希表复杂度})$ 时间算出来。

然后容斥加加减减就好了。

```cpp
val[3] -= 4 * val[4];
val[2] -= 6 * val[4] + 3 * val[3];
val[1] -= 2 * val[2] + 3 * val[3] + 4 * val[4];
val[0] -= val[1] + val[2] + val[3] + val[4];
```

